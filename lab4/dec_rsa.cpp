#include <iostream>
#include <gmp.h>
#include "dec.h"

using namespace std;

const char* N_str = "10715086071862673209484250490600018105614048117055336074437503883703510511249361224931983788156958581275946729175531469002933770824382865926730400902798743137187335810705309884635534159797732259520594337385186897629868362414475309001507719259272508669419676508606630823351242964205044695669333236417591";

const char* e_str = "10335071977839588495324343307012721241868030345867699233451500809021555989403028103743221782417440900848403102247012012875905268518785845678756696925714007988778268752026049276281025329038071087021446834856566687537729918372863729292015978809506607411711073716898691660211835403800810547133032654209857";

const char *c_star_s = "775789568255447714013247918834475198679653917741675336925599335265205597974556878796619688391490153400553690715156825186410083467239441867930362368759072824742512821423959166270736914130604102452801162684877374802075310241079026986641176079329871431448404341153307957496668749957011118721172866996397";

const char *m_text_s = "2";//or any number you set

int main()
{
	mpz_t N, e, c, mts;

	mpz_init_set_str(N, N_str, 10);
        mpz_init_set_str(e, e_str, 10);
	mpz_init_set_str(c, c_star_s, 10);
	mpz_init_set_str(mts, m_text_s, 10);// mts = 2

	mpz_t c_cipher, me;
	mpz_init(me);//
	mpz_init(c_cipher);//
	mpz_powm(me, mts, e, N);// me = mts^e
	mpz_mul(c_cipher, me, c);// c_cipher = me * c
	mpz_mod(c_cipher, c_cipher, N);// c_cipher %= N

        char *m = dec(c_cipher); //access the dec oracle
	mpz_t cip;
	mpz_init_set_str(cip, m, 10);
	mpz_invert(mts, mts, N);// mts = mts^-1 (mod N)
	mpz_mul(cip, cip, mts);
	mpz_mod(cip, cip, N);// cip = cip * mts (mod N), mts^-1 * mts * M = M

	gmp_printf("%Zd\n", cip);


 	return 0;
}
